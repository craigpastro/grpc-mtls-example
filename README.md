# mTLS Example in Go

## Certificates

Certificates were generated by [cfssl](https://github.com/cloudflare/cfssl).

The CA certificate was generated from [`ca.json`](certs/ca.json) with
```
cfssl genkey -initca ca.json | cfssljson -bare ca
```
The server uses the same [`ca.json`](certs/ca.json) generated with
```
cfssl gencert -ca ca.pem -ca-key ca-key.pem ca.json | cfssljson -bare server
```

A client certificate with echo privileges was generated from [`client-echo-scope.json`](certs/client-echo-scope.json) with
```
cfssl gencert -ca ca.pem -ca-key ca-key.pem client-echo-scope.json | cfssljson -bare client-echo-scope
```
and one without echo privileges was generated from [`client-no-scope.json`](certs/client-no-scope.json) with
 ```
cfssl gencert -ca ca.pem -ca-key ca-key.pem client-no-scope.json | cfssljson -bare client-no-scope
```

## Call the echo service

```
make SAY="hello" echo  # should work
make echo-no-auth  # should not work
make echo-no-tls   # should not work
```
